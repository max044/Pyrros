Itération extérieure I
┌─────────────────────────────────────────────────────────────────────────┐
│ 3. π_ref ← π_θ        (snapshot, reste gelé jusqu’à I+1)               │
│                                                                         │
│   Étapes internes step = 1 … M                                          │
│   ┌──────────────────────────────────────────────────────────────┐      │
│   │ 5. batch D_b                                                │      │
│   │ 6. π_old ← π_θ           (snapshot juste pour CE batch)     │      │
│   │ 7. Génère G sorties avec π_old                               │      │
│   │ 8. Récompenses r_i                                           │      │
│   │ 9. Avantages Â_i,t (groupe)                                  │      │
│   │                                                              │      │
│   │   Boucle d’optimisation GRPO 10…11 (µ iters)                 │      │
│   │   ┌───────────────────────────────────────────┐               │      │
│   │   │ Forward π_θ                                │               │      │
│   │   │ Ratio = π_θ / π_old (π_old fixe)           │               │      │
│   │   │ KL = KL(π_θ ‖ π_ref)   (π_ref fixe)        │               │      │
│   │   │ Back-prop + update π_θ                     │ (× μ fois)    │      │
│   │   └───────────────────────────────────────────┘               │      │
│   └──────────────────────────────────────────────────────────────┘      │
└─────────────────────────────────────────────────────────────────────────┘
